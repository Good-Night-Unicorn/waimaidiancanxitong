import{d as B,x as E,y as N,r as k,a as z,c as h,w as F,b as g,e as n,f as r,g as s,l as f,n as $,u as j,i as u,o as p,F as x,j as P,k as q,E as D,_ as I}from"./index-d6e43adc.js";const L={class:"auth"},M={class:"auth__panel card"},O={class:"actions"},T=B({__name:"RegisterPage",setup(A){const _=j(),i=E(),R=N(),m=k(),c=k(!1),t=z({username:"",phone:"",password:"",confirmPassword:"",city:i.state.city,district:i.state.district}),v=h(()=>i.cityOptions),y=h(()=>{var d;return((d=v.value.find(e=>e.value===t.city))==null?void 0:d.districts)??[]});F(()=>t.city,()=>{y.value.includes(t.district)||(t.district="")});const U={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:16,message:"用户名长度为2-16个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(d,e,a)=>{e!==t.password?a(new Error("两次输入的密码不一致")):a()},trigger:"blur"}],city:[{required:!0,message:"请选择所在城市",trigger:"change"}],district:[{required:!0,message:"请选择所在区域",trigger:"change"}]},C=async()=>{if(!(!m.value||!await m.value.validate().catch(()=>!1))){c.value=!0;try{R.register({username:t.username,phone:t.phone,password:t.password,city:t.city,district:t.district}),i.updateCity(t.city),i.updateDistrict(t.district),_.push({name:"login"})}catch(e){D.error(e.message)}finally{c.value=!1}}};return(d,e)=>{const a=u("el-input"),o=u("el-form-item"),b=u("el-option"),w=u("el-select"),V=u("el-button"),S=u("el-form");return p(),g("div",L,[e[12]||(e[12]=n("div",{class:"auth__illustration"},[n("img",{src:"https://images.unsplash.com/photo-1504753793650-d4a2b783c15e?auto=format&fit=crop&w=900&q=80",alt:"注册"})],-1)),n("div",M,[e[10]||(e[10]=n("h1",null,"创建账号",-1)),e[11]||(e[11]=n("p",{class:"tagline"},"注册成为会员，享受专属优惠与一键下单体验。",-1)),r(S,{ref_key:"formRef",ref:m,model:t,rules:U,"label-position":"top",size:"large"},{default:s(()=>[r(o,{label:"用户名",prop:"username"},{default:s(()=>[r(a,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=l=>t.username=l),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(o,{label:"手机号",prop:"phone"},{default:s(()=>[r(a,{modelValue:t.phone,"onUpdate:modelValue":e[1]||(e[1]=l=>t.phone=l),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),r(o,{label:"密码",prop:"password"},{default:s(()=>[r(a,{modelValue:t.password,"onUpdate:modelValue":e[2]||(e[2]=l=>t.password=l),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),r(o,{label:"确认密码",prop:"confirmPassword"},{default:s(()=>[r(a,{modelValue:t.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=l=>t.confirmPassword=l),type:"password",placeholder:"请再次输入密码","show-password":""},null,8,["modelValue"])]),_:1}),r(o,{label:"常用城市",prop:"city"},{default:s(()=>[r(w,{modelValue:t.city,"onUpdate:modelValue":e[4]||(e[4]=l=>t.city=l),placeholder:"请选择所在城市"},{default:s(()=>[(p(!0),g(x,null,P(v.value,l=>(p(),q(b,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(o,{label:"常住区域",prop:"district"},{default:s(()=>[r(w,{modelValue:t.district,"onUpdate:modelValue":e[5]||(e[5]=l=>t.district=l),placeholder:"请选择所在区域"},{default:s(()=>[(p(!0),g(x,null,P(y.value,l=>(p(),q(b,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(V,{type:"primary",size:"large",block:"",loading:c.value,onClick:C},{default:s(()=>[...e[7]||(e[7]=[f("注册",-1)])]),_:1},8,["loading"])]),_:1},8,["model"]),n("p",O,[e[9]||(e[9]=f(" 已经有账号？ ",-1)),r(V,{link:"",type:"primary",onClick:e[6]||(e[6]=l=>$(_).push({name:"login"}))},{default:s(()=>[...e[8]||(e[8]=[f("立即登录",-1)])]),_:1})])])])}}});const H=I(T,[["__scopeId","data-v-7cee73fd"]]);export{H as default};
